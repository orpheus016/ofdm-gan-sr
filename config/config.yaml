# =============================================================================
# CWGAN-GP OFDM Signal Reconstruction - Configuration
# MINI ARCHITECTURE for FPGA RTL Implementation
# =============================================================================

# -----------------------------------------------------------------------------
# OFDM Parameters (Mini Architecture)
# -----------------------------------------------------------------------------
ofdm:
  frame_length: 16            # Number of samples per OFDM frame (mini)
  num_subcarriers: 8          # Number of OFDM subcarriers (mini)
  cp_length: 2                # Cyclic prefix length (mini)
  modulation: "QPSK"          # Modulation scheme: QPSK for mini
  pilot_spacing: 4            # Pilot subcarrier spacing

# -----------------------------------------------------------------------------
# Channel Parameters (for synthetic data generation)
# -----------------------------------------------------------------------------
channel:
  snr_range: [0, 30]          # SNR range in dB for training
  snr_test: [5, 10, 15, 20]   # SNR values for testing
  channel_type: "awgn"        # Channel type: awgn (simpler for mini)
  doppler_freq: 50            # Max Doppler frequency (Hz)
  delay_spread: 1e-6          # RMS delay spread (seconds)

# -----------------------------------------------------------------------------
# Model Architecture (Mini - matches RTL)
# -----------------------------------------------------------------------------
model:
  # Generator (Mini U-Net) - matches rtl/generator_mini.v
  # Architecture: Input[2×16] → Enc[4×8] → Bneck[8×4] → Dec[4×8] → Out[2×16]
  generator:
    input_channels: 2         # I and Q components
    output_channels: 2
    frame_length: 16          # Mini frame length
    # Channel progression: 2 → 4 → 8 → 4 → 2
    enc1_channels: 4          # Encoder 1 output
    bottleneck_channels: 8    # Bottleneck output
    dec1_channels: 4          # Decoder 1 output
    kernel_size: 3
    activation: "leaky_relu"
    leaky_slope: 0.2
    output_activation: "tanh"
    use_skip_add: true        # Additive skip connections
    
  # Discriminator (Mini CNN Critic) - matches rtl/discriminator_mini.v
  # Architecture: Input[4×16] → Conv1[8×8] → Conv2[16×4] → Pool → Dense[1]
  discriminator:
    input_channels: 4         # Conditional: candidate(2) + condition(2)
    frame_length: 16          # Mini frame length
    # Channel progression: 4 → 8 → 16 → 1
    conv1_channels: 8
    conv2_channels: 16
    kernel_size: 3
    activation: "leaky_relu"
    leaky_slope: 0.2
    use_spectral_norm: false

# -----------------------------------------------------------------------------
# Training Configuration
# -----------------------------------------------------------------------------
training:
  # Basic settings
  batch_size: 64              # Larger batch for small model
  epochs: 500                 # More epochs for small model
  
  # Optimizer settings
  optimizer:
    type: "adam"
    lr_generator: 2e-4        # Slightly higher LR for small model
    lr_discriminator: 2e-4
    betas: [0.0, 0.9]         # WGAN-GP typically uses beta1=0
    weight_decay: 0
  
  # CWGAN-GP specific
  n_critic: 5                 # Discriminator steps per generator step
  gp_weight: 10.0             # Gradient penalty coefficient (lambda)
  
  # Loss weights
  loss:
    adversarial_weight: 1.0
    reconstruction_weight: 100.0  # L1 loss weight
    
  # Learning rate scheduling
  scheduler:
    type: "step"
    step_size: 100
    gamma: 0.5
    
  # Checkpointing
  checkpoint_interval: 50
  save_best: true

# -----------------------------------------------------------------------------
# Quantization (for FPGA deployment)
# -----------------------------------------------------------------------------
quantization:
  enabled: true
  weight_bits: 8              # Q1.7 weights
  activation_bits: 16         # Q8.8 activations
  accumulator_bits: 32        # Q16.16 accumulators
  per_channel_scale: true     # Per-channel quantization scales
  
# -----------------------------------------------------------------------------
# FPGA Target Specifications (Mini Architecture)
# -----------------------------------------------------------------------------
fpga:
  target_device: "Xilinx_Artix7"  # Smaller FPGA target
  clock_freq_mhz: 100         # Target clock frequency
  # Resource estimates for mini architecture:
  # Generator: ~6 DSPs, ~2 BRAMs, ~2500 FFs, ~3500 LUTs
  # Discriminator: ~6 DSPs, ~2 BRAMs, ~2000 FFs, ~3000 LUTs
  dsp_slices: 12
  bram_kb: 4
  
# -----------------------------------------------------------------------------
# Data Paths
# -----------------------------------------------------------------------------
paths:
  data_dir: "./data"
  train_dir: "./data/train"
  val_dir: "./data/val"
  test_dir: "./data/test"
  checkpoint_dir: "./checkpoints"
  log_dir: "./logs"
  export_dir: "./export"      # For FPGA weight export
  
# -----------------------------------------------------------------------------
# Logging & Visualization
# -----------------------------------------------------------------------------
logging:
  log_interval: 100           # Log every N batches
  tensorboard: true
  save_samples: true
  sample_interval: 500        # Save sample images every N batches
